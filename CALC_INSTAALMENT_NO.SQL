CREATE OR REPLACE FUNCTION CALC_INSTAALMENT_NO(CON_RECORD CONTRACTS%ROWTYPE)
RETURN NUMBER


IS
V_INSALLTMENT_NO NUMBER;
V_MONTHS NUMBER;



BEGIN

V_MONTHS:=MONTHS_BETWEEN(CON_RECORD.CONTRACT_ENDDATE,CON_RECORD.CONTRACT_STARTDATE);


IF CON_RECORD.CONTRACT_PAYMENT_TYPE='ANNUAL'  THEN
             V_INSALLTMENT_NO := V_MONTHS/12; 
         ELSIF CON_RECORD.CONTRACT_PAYMENT_TYPE='QUARTER' THEN
                V_INSALLTMENT_NO := V_MONTHS/3; 
          ELSIF CON_RECORD.CONTRACT_PAYMENT_TYPE='MONTHLY' THEN
               V_INSALLTMENT_NO := V_MONTHS/1;  
           ELSE
               V_INSALLTMENT_NO := V_MONTHS/6; 
           END IF; 

RETURN
V_INSALLTMENT_NO;


END;
SELECT*FROM USER_ERRORS;